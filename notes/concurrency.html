<!DOCTYPE html>

<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">

    <link href="../styles/maia.experimental.css" rel="stylesheet">

    <link href="../styles/portfolio.css" rel="stylesheet">

    <link href="../styles/bootstrap.css" rel="stylesheet">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script> <!-- JQuery-->




    <link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900&amp;subset=latin-ext" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css?family=Raleway:100,300,400,600&amp;subset=latin-ext" rel="stylesheet">
        <link href="http://fonts.googleapis.com/css?family=Roboto+Slab:300,400" rel="stylesheet" type="text/css">

        <script src="../scripts/handlebars-v4.0.5.js"></script>	<!-- handlebar library -->
    <script src="../scripts/bootstrap.min.js"></script> <!-- bootsrap libraries -->
    <script src="../scripts/jquery.lettering.js"></script>	<!-- lettering library -->
    <script src="../scripts/jquery.textillate.js"></script>	<!-- textillate library -->


    <title> Concurrency</title>
</head>

<body>

	               <!-- progress indicator-->
                   <div class="progress-indicator" aria-valuemin="0" aria-valuemax="100" role="progressbar">
						<div class="progress-indicator__wrapper">
						  <div class="progress-indicator__bar1"></div>
						  <div class="progress-indicator__bar2"></div>
						</div>
				</div>
	
				<!-- Header-->
				<header role="banner" class="page-header has-submenu">
					<nav class="page-header__drawer sticky-header">
						<div class="page-header__content content-controls content-controls--flex">
	
							<!-- for the home logo-->
							<div class="page-nav__header">
								<div class="page-logo-lockup gc-header-dt__lockup">
									<div title="Google Careers" aria-label="Google Careers" class="page-logo gc-header-dt__logo" data-ga-action="Header nav_Select" data-ga-label="Google Careers logo" role="menuitem">
										<div class="page-logo-text gc-header-dt__product-logo">
											<span aria-hidden="true" class="page-logo-text-span gc-header-dt__product-logo-text">Study space</span>
										</div>
									</div>
								</div>
	
							</div>
	
							<!--Container for the nav bars-->
							<div class="gc-header-dt__nav">
								<ul class="gc-header-dt__nav-list">

									<li class="gc-header-dt__nav-list-item">
											<a href="../index.html"  aria-label="Selected Link: Teams" data-ga-action="Header nav_Select" data-ga-label="Teams" role="menuitem">
												Home
											</a>
									</li>
									<li class="gc-header-dt__nav-list-item">
										<a href="../notes.html"  class="active" aria-label="Selected Link: Teams" data-ga-action="Header nav_Select" data-ga-label="Teams" role="menuitem">
											Notes
										</a>
									</li>
									<li class="gc-header-dt__nav-list-item">
										<a href="../resources.html" aria-label="Selected Link: Teams" data-ga-action="Header nav_Select" data-ga-label="Teams" role="menuitem">
											Resources
										</a>
									</li>

									<li class="gc-header-dt__nav-list-item">
											<a href="#"  aria-label="Selected Link: Teams" data-ga-action="Header nav_Select" data-ga-label="Teams" role="menuitem">
												Resume
											</a>
									</li>
								</ul>
	
							</div>
						
						</div>
	
                    </nav>
                    

                    <nav class="page-header__drawer sticky-header" >
                            <div class="page-header__content content-controls content-controls--flex" style="background-color: rgb(240,240,240);">
        
                                <!-- for the home logo-->
                                <div class="page-nav__header">
                                    <div class="page-logo-lockup gc-header-dt__lockup">
                                        <a href="#" title="Google Careers" aria-label="Google Careers" class="page-logo gc-header-dt__logo" data-ga-action="Header nav_Select" data-ga-label="Google Careers logo" role="menuitem">
                                            <div class="page-logo-text gc-header-dt__product-logo">
                                                <span aria-hidden="true" class="page-logo-text-span gc-header-dt__product-logo-text"></span>
                                            </div>
                                        </a>
                                    </div>
        
                                </div>
        
                                <!--Container for the nav bars-->
                                <div class="gc-header-dt__nav" style="margin-left: 11.8rem;">
                                    <ul class="gc-header-dt__nav-list">

                             
                                        <li class="gc-header-dt__nav-list-item">
                                            <a href="#" class="active"  role="menuitem"  >
                                                Concurrency
                                            </a>
                                        </li>
                                        <li class="gc-header-dt__nav-list-item">
                                            <a href="kafka.html" aria-label="Selected Link: Teams" role="menuitem" >
                                                Kafka
                                            </a>
                                        </li>
    
                                 
                                    </ul>
        
                                </div>
                            
                            </div>
        
                        </nav>
	
                </header>

<div class="page-body" data-modal-source id="a11y-main" role="main" tabindex="0">
    <div>
        <!-- <div class="blogPageLeftSide" id="knapsackLeftSide"></div> -->
        <div class="content-header--story"></div>


    </div>

    <div class="content-container content-row story-page story-page--restricted story-page--bottom">
        <div class="grid">

            <div class="grid__item desk--three-twelfths push--desk--one-twelfth tablet--four-twelfths">
                <div class="story-page__head-shot-container">
                    <div class="grid__item desk--four-twelfths story-page__head-shot-image" style="background-color:#fff;">
                    </div>
                    <div class="desk--eight-twelfths story-page__head-shot-caption">
                            <p class="story-page__head-shot-caption--text story-page__head-shot-name" tabindex="-1">System design</p>
                            <p class="head-shot-short-desc">Distributed systems, multi-threaded programming, concurrency</p>          
                    </div>
                </div>

            </div>
            <div class="grid__item desk--eight-twelfths push--desk--one-twelfth tablet--eight-twelfths story-page__story">
                <h1  class="content-title content-title--story">
                    Concurency, parallelism & distributed systems
                </h1>

        

                                                <p class="paragraphFontStyle"> 
                                                    We go about most of our day juggling multiple tasks. We start our day by making 
                                                    breakfast, and while breakfast is getting ready, we stretch in the mean time or 
                                                    prepare things to read for our commute to work.
                                                     </p>

                                                     <p class="paragraphFontStyle">
                                                        
                                                            At the office, we initiate a deployment process for a change we want to deploy, and 
                                                            while the application is deploying, we will either start to work on a different technical task, or 
                                                            decide to take a coffee break. Then while the coffee machine is in the process of making a Latte,
                                                            we go and quickly grab some snacks from the kitchen counter. 
                                                    </p>
                                                    <p class="paragraphFontStyle">
                                                            
                                                            We're quite adept at wisely handling multiple tasks throughout the day. At the same time, however, we can only do a single thing. 
                                                            We can’t get coffee while we’re in the process of initiating a deployment process; we can’t stretch while we’re actively cooking breakfast. 
                                                            We also can’t juggle our way through every type of task. Some tasks 
                                                            will  depend on other tasks. Regardless, we synchronize and execute our actions in a such way as to 
                                                            optimize our day. These situations are analogous to the concepts of concurrency and parallelism. 
                                                            Parallelism refers to the ability of a system to execute multiple tasks at the exact same time, 
                                                            while concurrency refers to the ability of a system to process multiple tasks independent of one 
                                                            another. However, concurrent tasks may or may NOT be executed simultaneously. If a system can execute 
                                                            tasks in parallel, then it must be a concurrent system as well. The other way around, however, is 
                                                            not the case.
                                                     </p>


                                                     <p class="paragraphFontStyle"> 
                                                        
                                                            These two concepts play a special role in distributed systems in which a vast 
                                                            number of resources are connected over a network, interact with one another, and execute a 
                                                            set of tasks. In distributed systems, a network of nodes and their resources mimick a single 
                                                            machine with each component executing its task independently and in parallel.
                                                     </p>
                                                     
                                                        <p class="paragraphFontStyle"> 
                                                                The way components in a distributed system juggle through their tasks is not unlike how we reason our way through 
                                                                the tasks we execute each day. Each machine must be able to use its local resources and 
                                                                execute its tasks in an optimal way. 
                                                         </p>


                                                         <p class="paragraphFontStyle"> 
                                                                 
                                                                So integrating concepts of parallelism & concurrency helps build a distributed system
                                                                whose components co-operate in a seamless and well orchestrated manner to execute the neccessary protocols. 
                                                                For exampke, imagine there is an application that produces messages 
                                                                into a Kafka cluster(a messaging system), and there is also  a consumer application that consumes the messages 
                                                                from Kafka on the other end. This consumer application will then process the messages and update 
                                                                some database.
                                                        </p>

                                                       <p class="paragraphFontStyle"> 
                                                            
                                                            If none of the applications in this scenerio are utilizing concurrency and/or
                                                            parallelism, this is what's most likely to happen:
                                                        </p>

                                                       <blockquote>
                                                            <ol>
                                                                <li>
                                                                        The consumer application would receive one message at a time
                                                                </li>
                                                                <li>
                                                                        Process that content while other tasks wait
                                                                </li>
                                                                <li>
                                                                        Put the processed content to the database
                                                                </li>
                                                            </ol>
                                                        </blockquote>

                                                        <p class="paragraphFontStyle"> 
                                                                This would result in a significant delay to the overall flow of data in the system and is therefore far from ideal.
                                                       </p>


                                                       <p class="paragraphFontStyle"> 
                                                           
                                                            One improvement that can be made to the consumer application is to have one independent ‘piece’ of the application retrieve content from Kafka, then another ‘piece’ would process the content and update the 
                                                            database. There can be more than one piece of the application update the database. Each 'piece' is capable of executing its tasks independently. This is just a minor improvement, however, and there are more improvements that can be made 
                                                            to the system. A lot of the improvements would depend on what exactly the application is doing, the nature of data it’s dealing with, and the configurations of Kafka & 
                                                            the database. 
                                                        </p>

                                                        <p class="paragraphFontStyle">
                                                                 Two possible technical terms that describe the independently executeable `pieces` are
                                                                 'Threads' & 'Processes'. A thread is the simplest independently executable piece of code by the operating system, 
                                                                and a process is simply a running instance of a program (a set of instructions). Threads divert functionality away from the main sequence of execution and operate 
                                                                in their own sequence of execution within a single process. It may be a single processor that’s 
                                                                juggling through these threads & processes, or there may be more than one processor(in which case parallelism is possible). 
                                                        </p>

                                            

                                                <p class="paragraphFontStyle"> 
                                                        Example: There is a message queue, and, in the interest of simplicity, there is one application that will produce messages to the queue, and also consume messages from the queue.
                                                        The sequence of events in a single threaded environment will look something like this:
                                                </p>

                                                <img src="../images/single_thread_producer_consumer.png" style=" width: 80%;"/>

                                      

                                                <p class="paragraphFontStyle"> 
                                                    
                                                        This particular approach doesn’t make much sense. At the very least producers and consumers should be independent entities. So, it makes more sense to have the consumers
                                                        and producers operate in separate threads. 
                                                </p>
                                               
                                                <img src="../images/multithreaded_consumer_producer.png" style=" width: 80%;"/>

                                                <p class="paragraphFontStyle"> 
                                                        Now say the producer is modified so that only numbers that are divisible by 7 are pushed into the queue. And to make things run faster,
                                                        There are now two producer threads. One producer thread will be responsible for repeatedly incrementing the shared number while the other thread 
                                                        will be responsible for checking the divisibility of the number and pushing it to the queue.
                                                </p>

                                                <img src="../images/race_condition_producer_consumer.png" style=" width: 80%;"/>


                                                <p class="paragraphFontStyle"> 
                                                    
                                                        The code in the picture above won’t always produce the desired result. Numbers that aren’t divisible by 7 could be pushed into the queue. This could happen 
                                                        due to the lack of co-ordination between the two threads when accessing shared data(also known as the 'critical section'). If the value of message is the number 7, 
                                                        the producer thread responsible for sending the messages will checks the number's divisibility, and before it sends the message, it could be switched out by the OS. 
                                                        The other producer thread may then go and increment the current value of the message to either 8 or 9. By the time the sender thread is active again and sends the message, 
                                                        the number in the message will no longer be divisible by 7. This event is known as a race condition, and it happens when multiple threads try to race their way through the shared data.
                                                </p>

                                                <p class="paragraphFontStyle"> 
                                                        There are two OS concurrency constructs that help prevent race conditions. The first construct is known as a Mutex. It can be thought of as a lock used to guard
                                                         the critical section. Once a thread acquires a mutex, only that thread can access the critical section. It will have to let go of the lock for other threads 
                                                         to gain access.  Once a thread releases a mutex, most mutex implementations arbitarily choose one of the waiting threads. 
                                                </p>


                                                 <p class="paragraphFontStyle"> 
                                                      
                                                         The second concurrency construct that helps prevent race conditions is a semaphore. A semaphore is used to restrict access to a critical section to a
                                                         fixed number of threads. It’s analogous to trying to get a reservation at a cafe. If there is no table available at the cafe, new customers can’t get in. But when a table frees 
                                                         up then a new person can enter the cafe. Thread pools, for example, are implemented using semaphores. If the consumer application in the 
                                                         Kafka-based data pipeline example above has a consumer thread pool size of 8, that means a maximum of eight threads at a time can consume from Kafka. 
                                                 </p>

                                                 <p class="paragraphFontStyle"> 
                                                      
                                                        Semaphores are also used as a signaling mechanism between threads. Semaphores can be used in the above message queue example 
                                                        to have the producer thread signal the consumer thread/s that content has been pushed into the queue.
                                                 </p>

                                                 <p class="paragraphFontStyle"> 
                                                      
                                                        Another important concurrency construct that is specific to programming languages than the OS is a Monitor. It combines the functionalities of a mutex 
                                                        and a semaphore, but it’s best to think of a Monitor as a Mutex with an an extra feature. The reason is because only a single thread can enter the monitor 
                                                        and access the critical section at a time. This extra feature that monitors have is the concept of condition variables. Based on the state of these condition variables, a 
                                                        thread can either lock and access a critical section or wait until the criteria for the condition variable is satisfied by another thread. Monitors can also 
                                                        be used as a signaling mechanism between the producer and consumer threads in the above example.
 
                                                 </p>

                                                 <img src="../images/monitors_consumer_producer.png" style=" width: 80%;"/>

                                                 <p class="paragraphFontStyle"> 
                                                      
                                                        So it is not hard to see that utilizing concepts of concurrency can help immensely in terms of throughput, latency and overall a more optimized use of resources. 
                                                        However, a lot of problems could potentially arise as well, especially if each component is not co-ordinated well enough. It’s also not easy to maintain 
                                                        and debug codebases with multi-threaded programming. If used in the wrong situation, it might result in the program slowing down as well. It’s really not 
                                                        unlike daily issues we face when context switch among several tasks we’re working on and as a result, we end up not making not as much progress as we 
                                                        would have liked. So it’s best to analyze each use case before deciding which route to take. It may be challenging, but it’s worth taking the time 
                                                        to learn more and improve.
                                                 </p>

                                                


                                          
            </div>
        </div>
    </div>

    <div class="page-row-2">
        <div class="content-container">
            <div class="grid">
                <div class="grid__item desk--eight-twelfths push--desk--four-twelfths tablet--eight-twelfths push--tablet--four-twelfths">
                    <h2 class="related-content__header">Related content</h2>
                        <!-- <div class="related-content__item related-content__item--compact">
                                <h3 class="related-content__title">Note 1</h3>
                                <p class="related-content__content related-content__content--always-open">Blah blah blah short description of note 1</p>
                                <a href="#" class="related-content__link">See More</a>
                        </div> -->
                        <!-- <div class="related-content__item related-content__item--compact">
                                <h3 class="related-content__title">Note 2</h3>
                                <p class="related-content__content related-content__content--always-open">Lorem ipsum blah blah descirption fo note 2 lorem ipsum shit</p>
                                <a href="#" class="related-content__link" >See More</a>
                        </div> -->




    

                        <!-- test 3-->
                        <div class="content-container mobile--hide" style="padding-left: 0;">
                            <div class="content-row content-row--flush-bottom related-content related-content--padded">
                                <div class="grid">

                                         <!--item 1-->
                                        <div class="grid__item tablet--one-half related-content__item--shifted desk--one-third">
                                            <div class="related-content__item">
                                                <h4 class="related-content__title">
                                                    <a  class="relatedContentLink" href="https://ocw.mit.edu/courses/civil-and-environmental-engineering/1-124j-foundations-of-software-engineering-fall-2000/lecture-notes/multithreading/">Multi-threading</a>
                                                </h4>
                                                <p class="related-content__content">
                                                    In-depth exploration of multi-threading concepts including Java implementing
                                                </p>
                                            </div>
                                        </div>


                                </div>
                            </div>
                        </div>



                       
                </div>
            </div>

        </div>

    </div>
</div>



<footer class="hashcode-footer mdl-mini-footer">
	    <div class="mdl-mini-footer__left-section">
		   <p class="mdl-typography--font-light">

              © 2020 Study space

			  <a href="../index.html">
			      Go to homepage
			  </a>

			  <a href="../notes.html">
			      Read notes
			  </a>

			  <a href="../resources.html">
			      Browse through resources
			  </a>


			  <a href="https://www.linkedin.com/in/nathnael-alemu-1b78bb107/">
			      View LinkedIn
			  </a>

		   </p>
		</div>

	</footer>


</body>


</html>